%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.597107e+003; foe(n+1)=1.579284e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.259661e+003; foe(n+1)=1.236062e+003; krok(n+1)=5.097061e-004; ng(n+1)=9.792587e+002;
n=2; farx(n+1)=3.137152e+002; foe(n+1)=2.970524e+002; krok(n+1)=3.663180e-002; ng(n+1)=1.323645e+002;
n=3; farx(n+1)=2.999937e+002; foe(n+1)=2.822081e+002; krok(n+1)=1.810600e-003; ng(n+1)=4.402912e+002;
n=4; farx(n+1)=2.833536e+002; foe(n+1)=2.659739e+002; krok(n+1)=1.879251e-003; ng(n+1)=4.617812e+002;
n=5; farx(n+1)=2.507578e+002; foe(n+1)=2.590787e+002; krok(n+1)=5.359529e-002; ng(n+1)=2.597130e+002;
n=6; farx(n+1)=2.327084e+002; foe(n+1)=2.323736e+002; krok(n+1)=1.961845e-001; ng(n+1)=3.257006e+002;
n=7; farx(n+1)=2.269701e+002; foe(n+1)=2.245046e+002; krok(n+1)=3.375584e-001; ng(n+1)=2.520105e+002;
n=8; farx(n+1)=2.111221e+002; foe(n+1)=2.200580e+002; krok(n+1)=9.512526e-001; ng(n+1)=1.121344e+002;
n=9; farx(n+1)=2.004757e+002; foe(n+1)=2.105630e+002; krok(n+1)=2.381432e+000; ng(n+1)=2.195370e+001;
n=10; farx(n+1)=1.999824e+002; foe(n+1)=2.104751e+002; krok(n+1)=2.710756e-002; ng(n+1)=7.456641e+001;
n=11; farx(n+1)=3.496607e+001; foe(n+1)=1.414248e+002; krok(n+1)=2.472812e+000; ng(n+1)=7.389168e+001;
n=12; farx(n+1)=3.304088e+001; foe(n+1)=1.412217e+002; krok(n+1)=2.861859e-004; ng(n+1)=1.532866e+003;
n=13; farx(n+1)=1.074804e+001; foe(n+1)=1.027417e+002; krok(n+1)=4.641165e-001; ng(n+1)=1.703434e+003;
n=14; farx(n+1)=1.018804e+001; foe(n+1)=9.937880e+001; krok(n+1)=2.425996e-003; ng(n+1)=1.855773e+003;
n=15; farx(n+1)=1.416454e+001; foe(n+1)=8.044883e+001; krok(n+1)=4.698917e-001; ng(n+1)=1.881787e+003;
n=16; farx(n+1)=1.299270e+001; foe(n+1)=6.958278e+001; krok(n+1)=4.319918e-001; ng(n+1)=1.277633e+003;
n=17; farx(n+1)=1.210150e+001; foe(n+1)=6.369379e+001; krok(n+1)=9.429061e-001; ng(n+1)=4.105098e+002;
n=18; farx(n+1)=1.179674e+001; foe(n+1)=6.000662e+001; krok(n+1)=9.372047e-001; ng(n+1)=1.735729e+002;
n=19; farx(n+1)=1.158055e+001; foe(n+1)=5.769743e+001; krok(n+1)=9.453922e-001; ng(n+1)=1.896235e+002;
n=20; farx(n+1)=9.002472e+000; foe(n+1)=5.428012e+001; krok(n+1)=1.170743e+000; ng(n+1)=3.340243e+002;
n=21; farx(n+1)=7.585400e+000; foe(n+1)=4.949569e+001; krok(n+1)=1.236644e+000; ng(n+1)=8.367245e+002;
n=22; farx(n+1)=6.668921e+000; foe(n+1)=4.738321e+001; krok(n+1)=3.963116e-001; ng(n+1)=2.336987e+002;
n=23; farx(n+1)=5.771434e+000; foe(n+1)=4.635196e+001; krok(n+1)=5.429402e-001; ng(n+1)=2.783982e+002;
n=24; farx(n+1)=5.170601e+000; foe(n+1)=4.575704e+001; krok(n+1)=8.356823e-001; ng(n+1)=3.368709e+002;
n=25; farx(n+1)=4.828158e+000; foe(n+1)=4.508593e+001; krok(n+1)=1.368663e+000; ng(n+1)=1.182099e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.830965e+000; foe(n+1)=4.500975e+001; krok(n+1)=1.445172e-005; ng(n+1)=1.660701e+002;
n=27; farx(n+1)=4.788091e+000; foe(n+1)=4.493626e+001; krok(n+1)=2.110229e-005; ng(n+1)=1.518162e+002;
n=28; farx(n+1)=4.864169e+000; foe(n+1)=4.491513e+001; krok(n+1)=1.864955e-004; ng(n+1)=2.500125e+001;
n=29; farx(n+1)=4.965489e+000; foe(n+1)=4.482388e+001; krok(n+1)=6.288803e-003; ng(n+1)=8.249347e+000;
n=30; farx(n+1)=4.898696e+000; foe(n+1)=4.476719e+001; krok(n+1)=3.559503e-003; ng(n+1)=1.440679e+001;
n=31; farx(n+1)=4.592755e+000; foe(n+1)=4.459163e+001; krok(n+1)=7.262643e-002; ng(n+1)=2.763061e+001;
n=32; farx(n+1)=4.814420e+000; foe(n+1)=4.455524e+001; krok(n+1)=1.389210e-001; ng(n+1)=1.070487e+002;
n=33; farx(n+1)=4.526699e+000; foe(n+1)=4.448338e+001; krok(n+1)=6.855549e-001; ng(n+1)=8.578420e+001;
n=34; farx(n+1)=4.314573e+000; foe(n+1)=4.443173e+001; krok(n+1)=1.799493e+000; ng(n+1)=1.018243e+001;
n=35; farx(n+1)=4.194955e+000; foe(n+1)=4.441737e+001; krok(n+1)=1.829080e+000; ng(n+1)=3.946581e+001;
n=36; farx(n+1)=4.128770e+000; foe(n+1)=4.441459e+001; krok(n+1)=8.707243e-001; ng(n+1)=9.219278e+000;
n=37; farx(n+1)=4.119837e+000; foe(n+1)=4.441435e+001; krok(n+1)=9.574267e-001; ng(n+1)=6.374490e+000;
n=38; farx(n+1)=4.107770e+000; foe(n+1)=4.441426e+001; krok(n+1)=7.113726e-001; ng(n+1)=2.427946e+000;
n=39; farx(n+1)=4.105136e+000; foe(n+1)=4.441426e+001; krok(n+1)=4.686024e-001; ng(n+1)=2.219723e+000;
n=40; farx(n+1)=4.104162e+000; foe(n+1)=4.441426e+001; krok(n+1)=7.679697e-001; ng(n+1)=1.543764e-001;
n=41; farx(n+1)=4.104095e+000; foe(n+1)=4.441426e+001; krok(n+1)=1.109214e+000; ng(n+1)=8.516916e-002;
n=42; farx(n+1)=4.104095e+000; foe(n+1)=4.441426e+001; krok(n+1)=3.652293e-006; ng(n+1)=1.356827e-002;
n=43; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=9.985661e-001; ng(n+1)=1.356823e-002;
n=44; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=8.840823e-007; ng(n+1)=6.700435e-005;
n=45; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=2.527585e-008; ng(n+1)=6.700430e-005;
 % z造 kierunek w metodzie zm - odnowa 
n=46; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=5.454092e-012; ng(n+1)=6.700429e-005;
n=47; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=1.122582e-011; ng(n+1)=6.700423e-005;
n=48; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=6.878633e-012; ng(n+1)=6.700424e-005;
 % z造 kierunek w metodzie zm - odnowa 
n=49; farx(n+1)=4.104123e+000; foe(n+1)=4.441426e+001; krok(n+1)=1.552182e-012; ng(n+1)=6.700424e-005;
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
